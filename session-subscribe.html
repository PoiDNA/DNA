<!DOCTYPE html>
<html lang="pl"><head><meta charset="UTF-8"><title>Subskrypcja</title>
<style>/* … dokładnie te same style … */</style></head><body>

<button id="toggleBtn">🔔 Informuj mnie o sesjach</button>

<div id="formWrap">
  <form id="subForm">
    <div class="row">
      <label class="emailField"><input type="email" id="email" placeholder="Email" required></label>
      <label class="regionField">
        <select id="regionDropdown" required>…lista regionów…</select>
      </label>
    </div>
    <button id="submitBtn" type="submit">Zapisz</button>
  </form>
  <div id="status"></div>
</div>

<script>
/* … (mapa REGIONS, auto-region, toggle) … */

/* —— ⬇ wysyłamy dane do strony Wix zamiast fetch’a ⬇ —— */
form.onsubmit = e => {
  e.preventDefault();
  const payload = { email: email.value.trim(), region: region.value };
  window.parent.postMessage({ subscribe: payload }, '*');
  status.textContent = '⏳ wysyłanie…';
};

/* —— odbieramy informację zwrotną —— */
window.addEventListener('message', ev => {
  if (ev.data?.saved) status.textContent = 'Dziękujemy! Zapisano ✅';
  if (ev.data?.error) status.textContent = '❌ ' + ev.data.error;
});

/* —— e-mail z rodzica —— */
window.addEventListener('message', ev => {
  if (ev.data && 'email' in ev.data) {
    email.value = ev.data.email || '';
    if (ev.data.email) email.placeholder = '';
  }
});
</script></body></html>
